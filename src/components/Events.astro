---
import { contentfulClient } from "../lib/contentful";
import { documentToHtmlString } from "@contentful/rich-text-html-renderer";
import type { Document } from "@contentful/rich-text-types";

interface EventosLa10 {
    contentTypeId: "eventosLa10";
    fields: {
        titulo: string;
        fecha: string;
        descripcion: Document;
        imagen: {
            fields: {
                title: string;
                description: string;
                file: {
                    url: string;
                    fileName: string;
                    contentType: string;
                };
            };
        };
    };
}

const events = await contentfulClient.getEntries<EventosLa10>({
    content_type: "eventosLa10",
});
---

<section id="news" class="eventos-section">
    <div class="evento-container">
        <div class="heading-text text-center">
            <h3><strong>NOTICIAS</strong></h3>
        </div>

        {
            events.items && events.items.length > 0 ? (
                <div class="eventos-grid">
                    {events.items.map(
                        (event: { fields: EventosLa10["fields"] }) => (
                            <div class="evento-card">
                                {event.fields.imagen?.fields?.file?.url && (
                                    <img
                                        src={`https:${event.fields.imagen.fields.file.url}`}
                                        alt={
                                            event.fields.imagen.fields.title ||
                                            "Evento imagen"
                                        }
                                        class="evento-imagen"
                                    />
                                )}
                                <div class="evento-contenido">
                                    {event.fields.titulo && (
                                        <h3 class="evento-titulo">
                                            {event.fields.titulo}
                                        </h3>
                                    )}
                                    {event.fields.descripcion && (
                                        <p class="evento-descripcion">
                                            {documentToHtmlString(
                                                event.fields.descripcion,
                                            )}
                                        </p>
                                    )}
                                    {event.fields.fecha && (
                                        <p class="evento-fecha">
                                            {new Date(
                                                event.fields.fecha,
                                            ).toLocaleDateString()}
                                        </p>
                                    )}
                                </div>
                            </div>
                        ),
                    )}
                </div>
            ) : (
                <p>No hay eventos disponibles en este momento.</p>
            )
        }
    </div>
</section>

<style>
    .eventos-section {
        padding: 3rem 0;
    }
    .evento-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
    }
    .heading-text {
        margin-bottom: 2rem;
    }
    .eventos-grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 2rem;
    }
    .evento-card {
        background-color: white;
        border-radius: 0.5rem;
        overflow: hidden;
        transition: box-shadow 0.3s ease-in-out;
        width: 100%;
        max-width: 350px;
        box-shadow:
            0 10px 15px -3px rgba(0, 0, 0, 0.1),
            0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    .evento-imagen {
        width: 100%;
        height: 250px;
        object-fit: cover;
    }
    .evento-contenido {
        padding: 1.5rem;
    }
    .evento-titulo {
        font-size: 1.25rem;
        font-weight: 600;
        margin: 0 0 0.75rem 0;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .evento-descripcion {
        font-size: 1rem;
        color: #4b5563;
        margin-bottom: 0.75rem;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    .evento-fecha {
        font-size: 0.875rem;
        color: #6b7280;
        font-weight: 500;
    }
    @media (min-width: 768px) {
        .eventos-grid {
            justify-content: center;
        }
        .evento-card {
            width: calc(50% - 1rem);
            max-width: 350px;
        }
    }
    @media (min-width: 1024px) {
        .eventos-grid {
            justify-content: flex-start;
        }
        .evento-card {
            width: calc(33.333% - 1.333rem);
        }
    }
</style>
